{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>–¢–∞—Ä–∏—Ö</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script>
        function copyLink(id) {
            var link = window.location.origin + "/test/" + id + "/";
            navigator.clipboard.writeText(link).then(() => alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!"));
        }
        function confirmDelete(url) {
            if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–µ—Å—Ç? –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–µ–Ω–∏–∫–æ–≤ —Ç–æ–∂–µ –∏—Å—á–µ–∑–Ω—É—Ç!")) {
                window.location.href = url;
            }
        }
    </script>
</head>
<body>
    <div class="page-container">
        <h2 style="text-align: center;">üìú –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h2>

        <div class="card">
            <h3 style="color: #00d2ff; margin-bottom: 15px;">üîó –ú–æ–∏ —Ç–µ—Å—Ç—ã</h3>
            <div class="table-scroll">
                <table>
                    {% for test in my_tests %}
                    <tr>
                        <td>
                            <div style="font-weight: bold;">{{ test.title }}</div>
                            <div style="font-size: 11px; color: #aaa;">{{ test.date_created|date:"d.m.Y" }}</div>
                        </td>
                        <td style="text-align: right; white-space: nowrap;">
                            <button onclick="copyLink({{ test.id }})" class="btn-copy" style="margin-right: 5px;">üîó</button>
                            
                            <button onclick="confirmDelete('{% url 'delete_test' test.id %}')" 
                                    style="background: #e74c3c; color: white; border: none; padding: 6px 10px; border-radius: 6px; cursor: pointer;">
                                üóëÔ∏è
                            </button>
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td>–¢–µ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç...</td></tr>
                    {% endfor %}
                </table>
            </div>
        </div>

        <div class="card">
            <h3 style="color: #38ef7d; margin-bottom: 15px;">üéì –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
            <div class="table-scroll">
                <table>
                    <tr><th>–£—á–µ–Ω–∏–∫</th><th>–ë–∞–ª–ª</th></tr>
                    {% for result in results %}
                    <tr>
                        <td>{{ result.student_name }}<br><small style="color: #aaa;">{{ result.test.title }}</small></td>
                        <td>
                            <b style="color: {% if result.score > result.total_questions|add:'-2' %}#38ef7d{% else %}#ff4757{% endif %};">
                                {{ result.score }}/{{ result.total_questions }}
                            </b>
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td>–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–µ—Ç...</td></tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    </div>

    {% include 'base_nav.html' %}
</body>
</html>