{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>–ù”ô—Ç–∏–∂–µ</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script>
        function toggleAnswers() {
            var block = document.getElementById("answers-block");
            if (block.style.display === "none") {
                block.style.display = "block";
                // –¢”©–º–µ–Ω–≥–µ “õ–∞—Ä–∞–π —Å—ã—Ä“ì—ã—Ç—É
                setTimeout(() => {
                    block.scrollIntoView({ behavior: 'smooth' });
                }, 100);
            } else {
                block.style.display = "none";
            }
        }
    </script>
    <style>
        .ans-card {
            background: rgba(255,255,255,0.05); 
            margin-bottom: 15px; padding: 20px; border-radius: 10px; 
            border-left: 5px solid gray; text-align: left;
        }
        .correct-card { border-left-color: #2ed573; background: rgba(46, 213, 115, 0.05); }
        .wrong-card { border-left-color: #ff4757; background: rgba(255, 71, 87, 0.05); }
        
        .opt { padding: 10px; margin: 5px 0; border-radius: 5px; opacity: 0.7; border: 1px solid transparent; }
        .opt.selected { font-weight: bold; border-color: white; opacity: 1; }
        
        /* –ñ–∞—É–∞–ø—Ç–∞—Ä–¥—ã“£ —Ç“Ø—Å—Ç–µ—Ä—ñ */
        .opt.correct { background: rgba(46, 213, 115, 0.6); color: black; }
        .opt.wrong { background: rgba(255, 71, 87, 0.6); color: white; }
    </style>
</head>
<body>
    <div class="page-container" style="text-align: center; max-width: 800px;">
        <div class="card">
            <h1>üèÅ –¢–µ—Å—Ç –∞—è“õ—Ç–∞–ª–¥—ã!</h1>
            <h2>{{ result.student_name }}</h2>
            
            <div style="font-size: 60px; font-weight: bold; margin: 20px 0; color: {% if result.score > result.total_questions|add:'-3' %}#2ed573{% else %}#ff4757{% endif %};">
                {{ result.score }} / {{ result.total_questions }}
            </div>

            <div style="display: flex; gap: 10px; justify-content: center; margin-top: 20px;">
                {% if user.is_authenticated %}
                    <a href="{% url 'dashboard' %}" class="btn-submit" style="background: #3a7bd5; width: auto;">üè† –ë–∞—Å—Ç—ã –±–µ—Ç</a>
                {% else %}
                    <a href="{% url 'user_login' %}" class="btn-submit" style="background: #57606f; width: auto;">üö™ –®—ã“ì—É</a>
                {% endif %}

                <button onclick="toggleAnswers()" class="btn-submit" style="background: #ffa502; width: auto;">üëÅÔ∏è “ö–∞—Ç–µ–º–µ–Ω –∂“±–º—ã—Å</button>
            </div>
        </div>

        <div id="answers-block" style="display: none; margin-top: 30px;">
            <h3 style="color: #00d2ff;">üìä –¢–æ–ª—ã“õ —Ç–∞–ª–¥–∞—É</h3>
            
            {% for item in analysis %}
            <div class="ans-card {% if item.is_correct %}correct-card{% else %}wrong-card{% endif %}">
                <p style="font-size: 18px; margin-bottom: 15px;"><strong>{{ forloop.counter }}. {{ item.question.text }}</strong></p>
                
                <div class="opt {% if item.selected == 1 %}selected {% if item.is_correct %}correct{% else %}wrong{% endif %}{% endif %} {% if item.correct_opt == 1 %}correct{% endif %}">
                    A) {{ item.question.option1 }}
                </div>
                
                <div class="opt {% if item.selected == 2 %}selected {% if item.is_correct %}correct{% else %}wrong{% endif %}{% endif %} {% if item.correct_opt == 2 %}correct{% endif %}">
                    B) {{ item.question.option2 }}
                </div>
                
                <div class="opt {% if item.selected == 3 %}selected {% if item.is_correct %}correct{% else %}wrong{% endif %}{% endif %} {% if item.correct_opt == 3 %}correct{% endif %}">
                    C) {{ item.question.option3 }}
                </div>
                
                <div class="opt {% if item.selected == 4 %}selected {% if item.is_correct %}correct{% else %}wrong{% endif %}{% endif %} {% if item.correct_opt == 4 %}correct{% endif %}">
                    D) {{ item.question.option4 }}
                </div>
            </div>
            {% endfor %}
        </div>

    </div>
</body>
</html>